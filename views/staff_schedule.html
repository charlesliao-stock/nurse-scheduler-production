<div class="page-section active">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2 style="margin:0;"><i class="fas fa-user-clock"></i> 我的班表與統計</h2>
    </div>
    
    <div class="toolbar" style="margin-bottom: 20px; display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
        <div class="form-group" style="margin:0;">
            <label>選擇月份：</label>
            <input type="month" id="scheduleMonth" class="form-control" style="width: 160px; display:inline-block;">
        </div>
        
        <button class="btn btn-primary" onclick="staffScheduleManager.loadData()">
            <i class="fas fa-search"></i> 查詢
        </button>
    </div>
    
    <!-- 統計卡片 -->
    <div class="score-cards-grid" style="grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); margin-bottom: 20px; gap: 10px;">
        <div class="score-card" style="padding: 10px;">
            <h5 style="color:#7f8c8d; margin:0; font-size: 0.9rem;">上班總數</h5>
            <h2 id="statTotalShifts" style="color:#2c3e50; margin:5px 0; font-size: 1.5rem;">0</h2>
        </div>
        <div class="score-card" style="padding: 10px;">
            <h5 style="color:#7f8c8d; margin:0; font-size: 0.9rem;">總休假</h5>
            <h2 id="statTotalOff" style="color:#27ae60; margin:5px 0; font-size: 1.5rem;">0</h2>
        </div>
        <div class="score-card" style="padding: 10px;">
            <h5 style="color:#7f8c8d; margin:0; font-size: 0.9rem;">假日休</h5>
            <h2 id="statHolidayOff" style="color:#e67e22; margin:5px 0; font-size: 1.5rem;">0</h2>
        </div>
        <div class="score-card" style="padding: 10px;">
            <h5 style="color:#7f8c8d; margin:0; font-size: 0.9rem;">小夜班</h5>
            <h2 id="statEvening" style="color:#8e44ad; margin:5px 0; font-size: 1.5rem;">0</h2>
        </div>
        <div class="score-card" style="padding: 10px;">
            <h5 style="color:#7f8c8d; margin:0; font-size: 0.9rem;">大夜班</h5>
            <h2 id="statNight" style="color:#c0392b; margin:5px 0; font-size: 1.5rem;">0</h2>
        </div>
        <div class="score-card" style="padding: 10px;">
            <h5 style="color:#7f8c8d; margin:0; font-size: 0.9rem;">換班數</h5>
            <h2 id="statExchangeCount" style="color:#3498db; margin:5px 0; font-size: 1.5rem;">0</h2>
        </div>
    </div>

    <!-- 橫式班表容器 -->
    <div class="card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); overflow-x: auto;">
        <div id="horizontalScheduleWrapper" style="min-width: 800px;">
            <table class="horizontal-calendar-table" style="width: 100%; border-collapse: collapse; table-layout: fixed;">
                <tr id="row-weekday">
                    <th style="width: 80px; background: #f8f9fa; border: 1px solid #dee2e6;">星期</th>
                    <!-- 動態插入星期 -->
                </tr>
                <tr id="row-date">
                    <th style="width: 80px; background: #f8f9fa; border: 1px solid #dee2e6;">日期</th>
                    <!-- 動態插入日期 -->
                </tr>
                <tr id="row-shift">
                    <th style="width: 80px; background: #f8f9fa; border: 1px solid #dee2e6;">班別</th>
                    <!-- 動態插入班別 -->
                </tr>
            </table>
        </div>
        <div id="noDataMessage" style="display:none; text-align:center; padding:40px; color:#999;">
            <i class="fas fa-calendar-times" style="font-size: 3rem; margin-bottom: 15px; display: block;"></i>
            本月尚無已發布的班表
        </div>
    </div>
</div>

<style>
.horizontal-calendar-table td, .horizontal-calendar-table th {
    border: 1px solid #dee2e6;
    text-align: center;
    padding: 8px 4px;
    font-size: 0.9rem;
}
.horizontal-calendar-table .weekday-cell {
    color: white;
    font-weight: bold;
}
.horizontal-calendar-table .date-cell {
    background: #f1f3f5;
    font-weight: bold;
}
.horizontal-calendar-table .shift-cell {
    padding: 10px 2px;
}
.horizontal-calendar-table .shift-box {
    display: inline-block;
    width: 90%;
    padding: 4px 0;
    border: 1px solid #adb5bd;
    background: #fff9db;
    border-radius: 4px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
}
.horizontal-calendar-table .shift-box:hover {
    background: #fff3bf;
    border-color: #f08c00;
    transform: scale(1.05);
}
.horizontal-calendar-table .weekend-sun { background-color: #c0392b !important; }
.horizontal-calendar-table .weekend-sat { background-color: #2980b9 !important; }
.horizontal-calendar-table .weekday-normal { background-color: #495057 !important; }
</style>

<!-- 換班彈窗 (保持不變) -->
<div id="exchangeModal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <h3><i class="fas fa-exchange-alt"></i> 提出換班申請</h3>
        <div id="exchangeInfo" style="background: #e7f5ff; padding: 15px; border-radius: 4px; margin-bottom: 15px; border-left: 4px solid #3498db;"></div>
        
        <div class="form-group">
            <label>選擇互換對象 (同一天班表)</label>
            <select id="exchangeTargetSelect" class="form-control">
                <option value="">載入中...</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>換班事由分類 <span style="color:red;">*</span></label>
            <select id="exchangeReasonCategory" class="form-control" onchange="staffScheduleManager.toggleOtherReason()">
                <option value="">請選擇...</option>
                <option value="unit_staffing_adjustment">單位人力調整</option>
                <option value="public_holiday">公假</option>
                <option value="sick_leave">病假</option>
                <option value="bereavement">喪假</option>
                <option value="support">支援</option>
                <option value="personal_factors">個人因素</option>
                <option value="other">其他</option>
            </select>
        </div>
        
        <div class="form-group" id="otherReasonGroup" style="display:none;">
            <label>其他原因說明 <span style="color:red;">*</span></label>
            <textarea id="otherReasonText" class="form-control" rows="2" placeholder="請填寫其他原因..."></textarea>
        </div>
        
        <div class="form-group">
            <label>具體原因說明</label>
            <textarea id="exchangeReason" class="form-control" rows="3" placeholder="請說明具體原因..."></textarea>
        </div>

        <div style="text-align:right; margin-top:20px;">
            <button class="btn btn-secondary" onclick="staffScheduleManager.closeExchangeModal()">取消</button>
            <button class="btn btn-primary" onclick="staffScheduleManager.submitExchange()">送出申請</button>
        </div>
    </div>
</div>
