<div class="page-section active" style="padding:0; height:100vh; display:flex; flex-direction:column;">
    
    <div style="padding:10px 20px; background:white; border-bottom:1px solid #ddd; display:flex; align-items:center; justify-content:space-between; flex-shrink:0;">
        <div style="display:flex; align-items:center; gap:15px;">
            <button class="btn" onclick="history.back()" style="background:#95a5a6; padding: 5px 10px; font-size: 0.9rem;">
                <i class="fas fa-arrow-left"></i> 返回列表
            </button>
            <h3 style="margin:0;" id="schTitle">排班載入中...</h3>
            <span id="schStatus" class="badge"></span>
        </div>
        
        <div style="display:flex; align-items:center; gap:8px;">
            <button class="btn" style="background:#8e44ad;" onclick="scheduleEditorManager.runAI()">
                <i class="fas fa-robot"></i> AI 自動排班
            </button>
            <span style="border-left:1px solid #ccc; height:20px; margin:0 5px;"></span>
            <button class="btn btn-primary" onclick="scheduleEditorManager.saveDraft()">
                <i class="fas fa-save"></i> 儲存
            </button>
            <button class="btn btn-success" onclick="scheduleEditorManager.publishSchedule()">
                <i class="fas fa-paper-plane"></i> 發布
            </button>
        </div>
    </div>

    <div style="flex:1; display:flex; overflow:hidden; flex-direction: column;">
        
        <div id="gapPool" style="flex-shrink:0; background:#fff3cd; border-bottom:1px solid #e0c46c; padding:5px; display:flex; gap:5px; align-items:center; overflow-x:auto; white-space:nowrap; height: 50px;">
            <span style="font-weight:bold; color:#856404; margin-right:10px; margin-left: 10px;"><i class="fas fa-exclamation-triangle"></i> 人力缺口:</span>
            <div id="gapItems" style="display:flex; gap:5px;"></div>
        </div>

        <div id="matrixArea" style="flex:1; overflow:auto; position:relative;">
            <table id="scheduleMatrix" oncontextmenu="return false;">
                <thead id="schHead"></thead>
                <tbody id="schBody"></tbody>
                <tfoot id="schFoot" style="position:sticky; bottom:0; background:#f9f9f9; z-index:25; font-weight:bold; border-top:2px solid #ddd;"></tfoot>
            </table>
        </div>
    </div>
</div>

<div id="schContextMenu" class="context-menu" style="display:none;">
    <div class="menu-header">設定班別</div>
    <div id="schMenuOptions" class="menu-options"></div>
</div>

<div id="aiResultModal" class="modal">
    <div class="modal-content" style="max-width: 900px;">
        <h3><i class="fas fa-robot"></i> AI 排班結果選擇</h3>
        <p style="color:#666;">系統生成了 3 種方案，請選擇最符合需求的版本：</p>
        
        <div id="aiOptionsContainer" style="display:flex; gap:20px; margin-top:20px; overflow-x:auto; padding-bottom:10px;">
            <div style="text-align:center; width:100%; padding:30px;">
                <i class="fas fa-spinner fa-spin"></i> 正在生成方案中...
            </div>
        </div>

        <div style="text-align:right; margin-top:20px; border-top:1px solid #eee; padding-top:15px;">
            <button class="btn btn-close" onclick="document.getElementById('aiResultModal').classList.remove('show')">取消</button>
        </div>
    </div>
</div>

<style>
    /* 班別方塊樣式 */
    .shift-block {
        display: inline-block; padding: 2px 6px; border-radius: 3px; 
        font-size: 0.85rem; font-weight: bold; cursor: grab;
        border: 1px solid rgba(0,0,0,0.1); user-select: none;
    }
    .shift-block:active { cursor: grabbing; }
    
    .cell-conflict {
        box-shadow: inset 0 0 0 2px #e74c3c !important;
        position: relative;
    }
    
    /* AI 選項卡片樣式 */
    .ai-option-card {
        flex: 1; border: 1px solid #ddd; border-radius: 8px; padding: 15px;
        background: #f9f9f9; transition: all 0.2s; min-width: 250px;
        display: flex; flex-direction: column;
    }
    .ai-option-card:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-color: #8e44ad; }
    .ai-option-title { font-size: 1.1rem; font-weight: bold; color: #2c3e50; margin-bottom: 10px; text-align: center; }
    .ai-metric { display: flex; justify-content: space-between; font-size: 0.9rem; margin-bottom: 5px; color: #555; }
    .ai-metric span:last-child { font-weight: bold; color: #333; }
    .btn-apply-ai { margin-top: auto; width: 100%; background: #8e44ad; color: white; border: none; padding: 8px; border-radius: 4px; cursor: pointer; }
    .btn-apply-ai:hover { background: #71368a; }
</style>
