<div class="page-section active">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2 style="margin:0;"><i class="fas fa-layer-group"></i> 組別管理</h2>
    </div>
    
    <div class="toolbar">
        <label style="margin-right:10px; font-weight:bold;">選擇單位：</label>
        <select id="filterGroupUnit" style="padding:8px; border-radius:4px; border:1px solid #ccc; width: 200px;">
            <option value="">載入中...</option>
        </select>
        <span style="color:#666; font-size:0.9rem; margin-left:10px;">(請先選擇單位以開始管理)</span>
    </div>

    <div id="groupMainArea" style="display:none; height: calc(100vh - 200px); display:flex; gap: 20px;">
        
        <!-- 左側：組別列表 -->
        <div style="flex: 1; background:white; border-radius:8px; padding:15px; box-shadow:0 2px 5px rgba(0,0,0,0.05); display:flex; flex-direction:column;">
            <h3 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">
                <i class="fas fa-list"></i> 組別列表
            </h3>
            
            <div style="display:flex; gap:5px; margin-bottom:15px;">
                <input type="text" id="inputNewGroupCode" placeholder="輸入組別代號 (如: A, B...)" style="flex:1; padding:8px; border:1px solid #ddd; border-radius:4px;">
                <button class="btn btn-add" onclick="groupManager.addGroup()">新增</button>
            </div>

            <div style="flex:1; overflow-y:auto; border:1px solid #eee; border-radius:4px;">
                <table style="width:100%;">
                    <thead style="background:#f8f9fa; position:sticky; top:0;">
                        <tr>
                            <th style="padding:10px; cursor:pointer;" onclick="groupManager.sortGroups()">
                                組別代號 <i id="sort_icon_group_list" class="fas fa-sort"></i>
                            </th>
                            <th style="width:80px; text-align:center;">操作</th>
                        </tr>
                    </thead>
                    <tbody id="groupListBody"></tbody>
                </table>
            </div>
        </div>

        <!-- 右側：人員分組 -->
        <div style="flex: 2; background:white; border-radius:8px; padding:15px; box-shadow:0 2px 5px rgba(0,0,0,0.05); display:flex; flex-direction:column;">
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #eee; padding-bottom:10px; margin-bottom:15px;">
                <h3 style="margin:0;"><i class="fas fa-users-cog"></i> 人員分組設定</h3>
                <button class="btn btn-primary" onclick="groupManager.saveStaffAssignments()">
                    <i class="fas fa-save"></i> 儲存分組變更
                </button>
            </div>

            <div style="flex:1; overflow-y:auto; border:1px solid #eee; border-radius:4px;">
                <table style="width:100%;">
                    <thead style="background:#f8f9fa; position:sticky; top:0; z-index:1;">
                        <tr>
                            <th style="cursor:pointer;" onclick="groupManager.sortStaff('employeeId')">
                                員工編號 <i id="sort_icon_group_staff_employeeId" class="fas fa-sort"></i>
                            </th>
                            <th style="cursor:pointer;" onclick="groupManager.sortStaff('displayName')">
                                姓名 <i id="sort_icon_group_staff_displayName" class="fas fa-sort"></i>
                            </th>
                            <th style="cursor:pointer;" onclick="groupManager.sortStaff('level')">
                                進階層級 <i id="sort_icon_group_staff_level" class="fas fa-sort"></i>
                            </th>
                            <th style="cursor:pointer;" onclick="groupManager.sortStaff('groupId')">
                                所屬組別 <i id="sort_icon_group_staff_groupId" class="fas fa-sort"></i>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="staffListBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="groupEmptyState" style="text-align:center; padding:50px; color:#999;">
        <h3><i class="fas fa-arrow-up"></i> 請先由上方下拉選單選擇單位</h3>
    </div>
</div>
