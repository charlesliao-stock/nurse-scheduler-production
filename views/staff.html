<div class="page-section active">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2 style="margin:0;"><i class="fas fa-users"></i> 人員管理</h2>
    </div>
    
    <div class="toolbar">
        <select id="filterUnitSelect" style="padding:8px; border-radius:4px; border:1px solid #ccc;">
            <option value="all">載入中...</option>
        </select>

        <input type="text" id="searchStaffInput" placeholder="搜尋員編或姓名..." style="padding:8px; border:1px solid #ccc; border-radius:4px; width:200px;">
        
        <div style="margin-left:auto;">
            <button class="btn btn-add" onclick="staffManager.openModal()"><i class="fas fa-plus"></i> 新增人員</button>
            <button class="btn btn-import" onclick="staffManager.openImportModal()"><i class="fas fa-file-import"></i> 批次匯入</button>
        </div>
    </div>

    <div class="table-container">
        <table id="staffTable">
            <thead>
                <tr>
                    <th>單位</th>
                    <th>員編</th>
                    <th>姓名</th>
                    <th>層級</th>
                    <th>組別</th>
                    <th>角色</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody id="staffTableBody">
                </tbody>
        </table>
    </div>
</div>

<div id="staffModal" class="modal">
    <div class="modal-content">
        <h3>人員資訊</h3>
        <input type="hidden" id="staffDocId">
        
        <div class="form-row">
            <div class="form-group">
                <label>員工編號 *</label>
                <input type="text" id="inputEmpId">
            </div>
            <div class="form-group">
                <label>姓名 *</label>
                <input type="text" id="inputName">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Email (登入帳號) *</label>
                <input type="email" id="inputEmail">
            </div>
            <div class="form-group">
                <label>預設密碼</label>
                <input type="text" id="defaultPwd" value="123456" disabled style="background:#eee;">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>所屬單位 *</label>
                <select id="inputUnit">
                    </select>
            </div>
            <div class="form-group">
                <label>進階層級 *</label>
                <select id="inputLevel">
                    <option value="N">N (新進)</option>
                    <option value="N1">N1</option>
                    <option value="N2">N2</option>
                    <option value="N3">N3</option>
                    <option value="N4">N4</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>組別</label>
                <input type="text" id="inputGroup" placeholder="例如: A組">
            </div>
            <div class="form-group">
                <label>到職日期</label>
                <input type="date" id="inputHireDate">
            </div>
        </div>

        <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
        <label style="font-weight:bold; margin-bottom:10px; display:block;">排班參數設定</label>
        
        <div style="display:flex; gap:20px;">
            <label><input type="checkbox" id="checkPregnant"> 懷孕 (22:00後不排)</label>
            <label><input type="checkbox" id="checkBreastfeeding"> 哺乳 (22:00後不排)</label>
            <label><input type="checkbox" id="checkBundle"> 可包班 (優先排連班)</label>
        </div>

        <div style="text-align:right; margin-top:25px;">
            <button class="btn btn-close" onclick="staffManager.closeModal()">取消</button>
            <button class="btn btn-add" onclick="staffManager.saveData()">儲存</button>
        </div>
    </div>
</div>

<div id="importModal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <h3><i class="fas fa-file-import"></i> 批次匯入人員</h3>
        
        <div style="background-color: #fff3cd; color: #856404; padding: 15px; border-radius: 5px; margin-bottom: 20px; border: 1px solid #ffeeba;">
            <i class="fas fa-exclamation-triangle"></i> <strong>重要提醒：</strong><br>
            請先確認所有人員的<strong>「所屬單位」</strong>皆已在「單位管理」中建立。<br>
            若 CSV 中的單位代碼在系統中找不到，該人員將無法正確歸屬單位。
        </div>

        <div style="margin-bottom: 20px;">
            <label style="display:block; font-weight:bold; margin-bottom:10px;">步驟 1：下載範例檔案</label>
            <button class="btn btn-close" style="background-color: #17a2b8; width: 100%;" onclick="staffManager.downloadTemplate()">
                <i class="fas fa-download"></i> 下載 CSV 範例檔
            </button>
            <p style="font-size: 0.85rem; color: #666; margin-top: 5px;">請依照範例格式填寫，勿更動欄位順序。</p>
        </div>

        <div style="margin-bottom: 20px; border-top: 1px solid #eee; padding-top: 20px;">
            <label style="display:block; font-weight:bold; margin-bottom:10px;">步驟 2：上傳 CSV 檔案</label>
            <input type="file" id="csvFileInput" accept=".csv" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px;">
        </div>

        <div id="importResult" style="margin-bottom:15px; font-size: 0.9rem;"></div>

        <div style="text-align:right;">
            <button class="btn btn-close" onclick="staffManager.closeImportModal()">取消</button>
            <button class="btn btn-add" onclick="staffManager.processImport()">開始匯入</button>
        </div>
    </div>
</div>
