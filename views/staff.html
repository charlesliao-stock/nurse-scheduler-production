<div class="page-section active">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2 style="margin:0;"><i class="fas fa-users"></i> 人員管理</h2>
    </div>
    
    <div class="toolbar">
        <select id="filterUnitSelect" style="padding:8px; border-radius:4px; border:1px solid #ccc;">
            <option value="all">載入中...</option>
        </select>
        <input type="text" id="searchStaffInput" placeholder="搜尋員編或姓名..." style="padding:8px; border:1px solid #ccc; border-radius:4px; width:200px;">
        <div style="margin-left:auto;">
            <button class="btn btn-add" onclick="staffManager.openModal()"><i class="fas fa-plus"></i> 新增人員</button>
            <button class="btn btn-import" onclick="staffManager.openImportModal()"><i class="fas fa-file-import"></i> 批次匯入</button>
        </div>
    </div>

    <div class="table-container">
        <table id="staffTable">
            <thead>
                <tr>
                    <th>單位</th>
                    <th>員編</th>
                    <th>姓名</th>
                    <th>層級</th>
                    <th>組別</th>
                    <th>系統權限</th> <th>操作</th>
                </tr>
            </thead>
            <tbody id="staffTableBody"></tbody>
        </table>
    </div>
</div>

<div id="staffModal" class="modal">
    <div class="modal-content">
        <h3>人員資訊</h3>
        <input type="hidden" id="staffDocId">
        
        <div class="form-row">
            <div class="form-group">
                <label>員工編號 *</label>
                <input type="text" id="inputEmpId">
            </div>
            <div class="form-group">
                <label>姓名 *</label>
                <input type="text" id="inputName">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Email (登入帳號) *</label>
                <input type="email" id="inputEmail">
            </div>
            <div class="form-group">
                <label>預設密碼</label>
                <input type="text" id="defaultPwd" value="123456" disabled style="background:#eee;">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>所屬單位 * (將連動組別)</label>
                <select id="inputUnit" onchange="staffManager.onUnitChange()">
                    </select>
            </div>
            <div class="form-group">
                <label>組別 (依單位設定)</label>
                <select id="inputGroup">
                    <option value="">(請先選擇單位)</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>進階層級 *</label>
                <select id="inputLevel">
                    <option value="N">N (新進)</option>
                    <option value="N1">N1</option>
                    <option value="N2">N2</option>
                    <option value="N3">N3</option>
                    <option value="N4">N4</option>
                </select>
            </div>
            <div class="form-group">
                <label>系統權限 *</label>
                <select id="inputRole">
                    <option value="user">一般使用者 (預設)</option>
                    <option value="unit_scheduler">單位排班者</option>
                    <option value="unit_manager">單位管理者</option>
                    </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>到職日期</label>
                <input type="date" id="inputHireDate">
            </div>
            <div class="form-group">
                </div>
        </div>

        <hr style="border:0; border-top:1px solid #eee; margin:15px 0;">
        <label style="font-weight:bold; margin-bottom:10px; display:block;">排班參數設定</label>
        
        <div style="display:flex; gap:20px;">
            <label><input type="checkbox" id="checkPregnant"> 懷孕 (22:00後不排)</label>
            <label><input type="checkbox" id="checkBreastfeeding"> 哺乳 (22:00後不排)</label>
            <label><input type="checkbox" id="checkBundle"> 可包班 (優先排連班)</label>
        </div>

        <div style="text-align:right; margin-top:25px;">
            <button class="btn btn-close" onclick="staffManager.closeModal()">取消</button>
            <button class="btn btn-add" onclick="staffManager.saveData()">儲存</button>
        </div>
    </div>
</div>

<div id="importModal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <h3><i class="fas fa-file-import"></i> 批次匯入人員</h3>
        <div style="margin-bottom: 20px;">
            <button class="btn btn-close" style="background-color: #17a2b8; width: 100%;" onclick="staffManager.downloadTemplate()">
                <i class="fas fa-download"></i> 下載 CSV 範例檔
            </button>
        </div>
        <div style="margin-bottom: 20px;">
            <input type="file" id="csvFileInput" accept=".csv" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px;">
        </div>
        <div id="importResult" style="margin-bottom:15px; font-size: 0.9rem;"></div>
        <div style="text-align:right;">
            <button class="btn btn-close" onclick="staffManager.closeImportModal()">取消</button>
            <button class="btn btn-add" onclick="staffManager.processImport()">開始匯入</button>
        </div>
    </div>
</div>
