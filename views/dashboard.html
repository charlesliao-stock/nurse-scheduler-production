<div class="page-section active">
    <div style="margin-bottom: 20px;">
        <h2 style="margin:0; color:#2c3e50;"><i class="fas fa-tachometer-alt"></i> 儀表板</h2>
        <p style="color:#7f8c8d; margin-top:5px;">歡迎回來，請選擇上方或左側功能表開始操作。</p>
    </div>

    <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 30px;">
        <div class="card" style="flex: 1; min-width: 250px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid #3498db;">
            <div style="font-size: 0.9rem; color: #7f8c8d; font-weight: bold;">人員總數</div>
            <div style="font-size: 2rem; font-weight: bold; color: #2c3e50; margin: 10px 0;" id="dashStaffCount">-</div>
            <div style="font-size: 0.8rem; color: #3498db; cursor: pointer;" onclick="location.hash='/admin/staff'">前往管理 <i class="fas fa-arrow-right"></i></div>
        </div>

        <div class="card" style="flex: 1; min-width: 250px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid #f39c12;">
            <div style="font-size: 0.9rem; color: #7f8c8d; font-weight: bold;">進行中的預班</div>
            <div style="font-size: 2rem; font-weight: bold; color: #2c3e50; margin: 10px 0;" id="dashPreCount">-</div>
            <div style="font-size: 0.8rem; color: #f39c12; cursor: pointer;" onclick="location.hash='/admin/pre_schedules'">查看進度 <i class="fas fa-arrow-right"></i></div>
        </div>

        <div class="card" style="flex: 1; min-width: 250px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid #2ecc71;">
            <div style="font-size: 0.9rem; color: #7f8c8d; font-weight: bold;">本月排班狀態</div>
            <div style="font-size: 1.2rem; font-weight: bold; color: #2c3e50; margin: 15px 0;" id="dashScheduleStatus">未發布</div>
            <div style="font-size: 0.8rem; color: #2ecc71; cursor: pointer;" onclick="location.hash='/admin/schedule_list'">排班作業 <i class="fas fa-arrow-right"></i></div>
        </div>
    </div>

    <div style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
        <h3 style="border-bottom: 1px solid #eee; padding-bottom: 10px; margin-top: 0;">
            <i class="fas fa-info-circle"></i> 系統操作指引
        </h3>
        <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 20px;">
            <div style="flex: 1; min-width: 300px;">
                <h4 style="color:#2980b9;">第一階段：資料設定</h4>
                <ul style="color:#555; line-height: 1.8;">
                    <li>前往 <b><i class="fas fa-hospital-alt"></i> 單位管理</b> 設定您的單位。</li>
                    <li>前往 <b><i class="fas fa-clock"></i> 班別管理</b> 設定早、中、晚、夜等班別。</li>
                    <li>前往 <b><i class="fas fa-users"></i> 人員管理</b> 匯入或新增護理人員資料。</li>
                </ul>
            </div>
            <div style="flex: 1; min-width: 300px;">
                <h4 style="color:#e67e22;">第二階段：預班收集</h4>
                <ul style="color:#555; line-height: 1.8;">
                    <li>在 <b>預班管理</b> 開啟新的月份預班表。</li>
                    <li>通知同仁登入系統填寫預班與包班意願。</li>
                    <li>預班截止後，點擊「執行排班」進入正式排班。</li>
                </ul>
            </div>
            <div style="flex: 1; min-width: 300px;">
                <h4 style="color:#27ae60;">第三階段：AI 排班</h4>
                <ul style="color:#555; line-height: 1.8;">
                    <li>進入 <b>排班作業列表</b> 點擊編輯。</li>
                    <li>設定 <b>排班規則</b> (容許誤差、回溯深度)。</li>
                    <li>點擊 <b>AI 自動排班</b>，系統將自動運算並填入班表。</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        // 簡單的 Dashboard 統計邏輯 (可選)
        (async function() {
            try {
                // 這裡可以呼叫 API 獲取真實數據
                // 暫時顯示靜態或簡單讀取
                if(typeof db !== 'undefined') {
                    const staffSnap = await db.collection('users').where('isActive', '==', true).get();
                    document.getElementById('dashStaffCount').textContent = staffSnap.size || 0;
                }
            } catch(e) {
                console.log("Dashboard stats error:", e);
            }
        })();
    </script>
</div>
