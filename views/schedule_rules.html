<div class="page-section active">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2 style="margin:0;"><i class="fas fa-cogs"></i> 排班規則設定</h2>
    </div>
    
    <div class="toolbar" style="background:#fff; padding:15px; border-radius:5px; box-shadow:0 2px 5px rgba(0,0,0,0.05); margin-bottom:20px;">
        <label style="margin-right:10px; font-weight:bold;">設定單位：</label>
        <select id="ruleUnitSelect" style="padding:8px; border-radius:4px; border:1px solid #ccc; width: 250px;">
            <option value="">載入中...</option>
        </select>
        <button class="btn btn-add" onclick="scheduleRuleManager.saveData()" style="margin-left:auto;">
            <i class="fas fa-save"></i> 儲存規則
        </button>
    </div>

    <div id="rulesContainer" style="display:none; background:#fff; border-radius:5px; box-shadow:0 2px 5px rgba(0,0,0,0.05); padding:20px;">
        
        <div class="rule-card">
            <h4 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px; color:#2c3e50;">
                <i class="fas fa-ruler-combined"></i> 1. 單位規範 (硬規則)
            </h4>
            
            <div class="form-group">
                <label style="display:flex; align-items:center; cursor:pointer; font-weight:bold;">
                    <input type="checkbox" id="rule_minGap11" style="width:auto; margin-right:10px;">
                    班別間隔需大於 11 小時 (N 不接 D)
                </label>
                <div style="color:#666; font-size:0.9rem; margin-left:25px; margin-top:5px;">
                    若勾選，AI 將嚴格禁止「大夜接白班」或「大夜接小夜」等排法。
                </div>
            </div>

            <div class="form-group">
                <label style="font-weight:bold;">連續上班天數上限</label>
                <div style="display:flex; align-items:center; gap:10px; margin-top:5px;">
                    <input type="number" id="rule_maxConsDays" class="form-control" style="width:100px;" value="6">
                    <span>天</span>
                </div>
                <small style="color:#666;">超過此天數強制排休。</small>
            </div>

            <div class="form-group">
                <label style="font-weight:bold;">夜班公平標準 (變異數)</label>
                <div style="display:flex; align-items:center; gap:10px; margin-top:5px;">
                    <input type="number" id="rule_fairNightVar" class="form-control" style="width:100px;" value="2">
                </div>
                <small style="color:#666;">數值越小，大家的大小夜班數會越平均 (預設 2)。</small>
            </div>
        </div>

        <div class="rule-card" style="margin-top:20px;">
            <h4 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px; color:#2c3e50;">
                <i class="fas fa-robot"></i> 2. AI 運算參數
            </h4>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                <div class="form-group">
                    <label style="font-weight:bold;">容許誤差 (Tolerance)</label>
                    <input type="number" id="ai_tolerance" class="form-control" value="2">
                    <small style="color:#666;">兩人休假/夜班數差異在此範圍內，視為平等。</small>
                </div>
                <div class="form-group">
                    <label style="font-weight:bold;">回溯深度 (Backtrack Depth)</label>
                    <input type="number" id="ai_backtrack_depth" class="form-control" value="3">
                    <small style="color:#666;">遇到死局時，AI 往回修改的天數。</small>
                </div>
                <div class="form-group">
                    <label style="font-weight:bold;">單格嘗試上限 (Max Attempts)</label>
                    <input type="number" id="ai_max_attempts" class="form-control" value="20">
                    <small style="color:#666;">防止 AI 在同一格卡太久。</small>
                </div>
            </div>
        </div>

        <div class="rule-card" style="margin-top:20px;">
            <h4 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px; color:#2c3e50;">
                <i class="fas fa-balance-scale"></i> 3. 進階權重 (非必要勿動)
            </h4>
            <div style="display:flex; gap:20px;">
                <div class="form-group">
                    <label>勞逸平均權重</label>
                    <input type="number" id="ai_w_balance" class="form-control" value="200">
                </div>
                <div class="form-group">
                    <label>連續性權重</label>
                    <input type="number" id="ai_w_continuity" class="form-control" value="50">
                </div>
                <div class="form-group">
                    <label>積假權重</label>
                    <input type="number" id="ai_w_surplus" class="form-control" value="150">
                </div>
            </div>
        </div>

    </div>
</div>

<style>
    .rule-card {
        border: 1px solid #eee;
        padding: 20px;
        border-radius: 5px;
        background: #fafafa;
    }
    .form-group { margin-bottom: 15px; }
    .form-control {
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        width: 100%;
    }
</style>
